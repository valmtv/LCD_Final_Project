let make_adder = fun (x: int) -> (
  fun (y: int) -> x + y
) in

let fib_iter = fun (n: int) -> (
  if n <= 1 then n
  else (
    let a = new(0) in
    let b = new(1) in
    let i = new(1) in
    while !i < n do (
      let temp = !a + !b in
      a := !b;
      b := temp;
      i := !i + 1
    );
    !b
  )
) in

printString("--- START ---");
printEndLine();

printString("Curried Adder: ");
let add10 = make_adder(10) in
printInt(add10(5));
printEndLine();

printString("Fibonacci Loop: ");
let idx = new(0) in
while !idx < 6 do (
  let f = fib_iter(!idx) in
  printInt(!idx);
  printString(":");
  printInt(f);
  printString("  ");
  idx := !idx + 1
);
printEndLine();

let pair_val = (100, 200) in
printString("Tuple Access: ");
printInt(pair_val.0 + pair_val.1);
printEndLine();

let list_val = [1, 2, 3, 4] in
printString("List Access: ");
printInt(list_val[3]);
printEndLine();

let rec_val = {id = 50; val = 60} in
printString("Record Access: ");
printInt(rec_val.id + rec_val.val);
printEndLine();

printString("--- DONE ---");
printEndLine()